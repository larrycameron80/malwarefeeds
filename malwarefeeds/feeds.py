# -*- coding: utf-8 -*-
"""An Engine to handle the malware feeds."""

import logging
import urllib2

user_agent = {'User-agent': 'Mozilla/5.0 (X11; U; Linux i686)'}


def download(url):
    """
    Execute download from a URL.

    :param url: URL to access
    :return: urllib2 response or None
    """
    try:
        r = urllib2.Request(url, headers=user_agent)
        return urllib2.urlopen(r)
    except Exception as e:
        logging.error('Failure, %s' % e)
        return None


def get_malcode():
    """
    Get URL http://malc0de.com/rss content.

    :return: The Malc0de URL content
    """
    return download('http://malc0de.com/rss')


def get_mdl():
    """
    Get URL http://www.malwaredomainlist.com/hostslist/mdl.xml content.

    :return: The Malware Domain List URL content
    """
    return download('http://www.malwaredomainlist.com/hostslist/mdl.xml')


def get_vxvault():
    """
    Get URL http://vxvault.net/URL_List.php content.

    :return: The VxVault URL content
    """
    return download('http://vxvault.net/URL_List.php')


def get_malwareurls():
    """
    Get URL http://malwareurls.joxeankoret.com/normal.txt content.

    :return: The Joxean Koret Malware URLs content
    """
    return download('http://malwareurls.joxeankoret.com/normal.txt')


def get_ransomware():
    """
    Get URL https://ransomwaretracker.abuse.ch/downloads/RW_URLBL.txt content.

    :return: The Ransomware Tracker URLs content
    """
    return download('https://ransomwaretracker.abuse.ch/downloads/RW_URLBL.txt')
