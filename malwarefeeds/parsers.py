# -*- coding: utf-8 -*-
"""Parse XML feeds and text feeds."""

import feedparser
import re


def parse_xml_list_desc(response):
    """Parse a XML Feed."""
    feed = feedparser.parse(response)

    for entry in feed.entries:
        desc = entry.description
        url = desc.split(' ')[1].rstrip(',')
        if url == '':
            continue
        if url == '-':
            url = desc.split(' ')[4].rstrip(',')
        url = re.sub('&amp;', '&', url)
        if not re.match('http', url):
            url = 'http://' + url
        yield url


def parse_txt_file(response, splitter=b'\r\n'):
    """Parse text files and split it."""
    if response is None:
        yield
        return

    for url in response.split(splitter):
        if url.startswith(b'http'):
            yield url.decode()
